{{/* layouts/shortcodes/dialog.html */}}
{{ $icon           := .Get "icon" | default "ðŸ’¬" }}
{{ $title          := .Get "title" | default "" }}
{{ $primaryLabel   := .Get "primary_label" | default "" }}
{{ $primaryHref    := .Get "primary_href" | default "#" }}
{{ $secondaryLabel := .Get "secondary_label" }}
{{ $secondaryHref  := .Get "secondary_href" | default "#" }}
{{ $variant        := (.Get "variant" | default "material" | lower) }}

/* Intentamos leer botones dinÃ¡micos desde JSON */
{{ $buttonsRaw := .Get "buttons" }}
{{ $buttons := slice }}

{{ if $buttonsRaw }}
  {{/* buttons='[{"label":"...","href":"...","kind":"primary"}]' */}}
  {{ $buttons = $buttonsRaw | transform.Unmarshal }}
{{ else }}
  {{/* fallback al esquema viejo: primary + secondary */}}
  {{ if $primaryLabel }}
    {{ $buttons = $buttons | append (dict
      "label" $primaryLabel
      "href"  $primaryHref
      "kind"  "primary"
    ) }}
  {{ end }}

  {{ if $secondaryLabel }}
    {{ $buttons = $buttons | append (dict
      "label" $secondaryLabel
      "href"  $secondaryHref
      "kind"  "secondary"
    ) }}
  {{ end }}
{{ end }}

<div class="dialog-box dialog-variant-{{ $variant }}">
  <div class="dialog-header">
    <span class="dialog-icon">{{ $icon }}</span>
    {{ if $title }}
      <h3 class="dialog-title">{{ $title }}</h3>
    {{ end }}
  </div>

  <div class="dialog-body">
    {{ .Inner | markdownify }}
  </div>

  {{ if gt (len $buttons) 0 }}
    <div class="dialog-footer">
      {{ range $i, $btn := $buttons }}
        {{ $label := index $btn "label" }}
        {{ if $label }}
          {{ $href := (index $btn "href" | default "#") }}
          {{ $kind := (index $btn "kind" | default "secondary" | lower) }}
          {{ $btnIcon := index $btn "icon" }}

          <a href="{{ $href }}" class="dialog-button dialog-button--{{ $kind }}">
            {{ with $btnIcon }}
              <span class="dialog-button-icon">{{ . }}</span>
            {{ end }}
            <span class="dialog-button-label">{{ $label }}</span>
          </a>
        {{ end }}
      {{ end }}
    </div>
  {{ end }}
</div>
